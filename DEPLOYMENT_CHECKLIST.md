# 部署检查清单

使用此清单确保部署过程完整无误。

## 前置准备

- [ ] GitHub 仓库已创建并推送代码
- [ ] MongoDB Atlas 账户已创建
- [ ] Vercel 账户已创建
- [ ] Railway/Render 账户已创建

## MongoDB 配置

- [ ] MongoDB 集群已创建（M0 免费层）
- [ ] 数据库用户已创建（记住用户名和密码）
- [ ] 网络访问已配置（添加 `0.0.0.0/0` 允许所有 IP）
- [ ] 连接字符串已获取并测试

## 后端部署

### Railway
- [ ] 项目已连接到 GitHub 仓库
- [ ] 根目录设置为 `backend`
- [ ] 环境变量已配置：
  - [ ] `MONGODB_URI`
  - [ ] `JWT_SECRET` (强随机字符串)
  - [ ] `PORT` = `5000`
  - [ ] `NODE_ENV` = `production`
  - [ ] `CORS_ORIGIN` = 前端 URL (部署前端后更新)
- [ ] 部署成功
- [ ] 后端 URL 已获取
- [ ] 健康检查通过: `https://your-backend.railway.app/api/health`

### Render (备选)
- [ ] Web Service 已创建
- [ ] 连接到 GitHub 仓库
- [ ] 根目录设置为 `backend`
- [ ] 构建命令: `npm install && npm run build`
- [ ] 启动命令: `npm start`
- [ ] 环境变量已配置（同 Railway）
- [ ] 部署成功
- [ ] 后端 URL 已获取

## 前端部署

- [ ] Vercel 项目已创建
- [ ] 连接到 GitHub 仓库
- [ ] 框架预设: Next.js
- [ ] 根目录设置为 `frontend`
- [ ] 环境变量已配置:
  - [ ] `NEXT_PUBLIC_API_BASE_URL` = 后端 URL
- [ ] 部署成功
- [ ] 前端 URL 已获取

## 后端 CORS 更新

- [ ] 后端 `CORS_ORIGIN` 环境变量已更新为前端 URL
- [ ] 后端服务已重启
- [ ] CORS 配置验证通过

## 功能测试

- [ ] 前端页面可以访问
- [ ] 用户注册功能正常
- [ ] 用户登录功能正常
- [ ] 文章提交功能正常
- [ ] 文章搜索功能正常
- [ ] 管理员功能正常（如适用）
- [ ] 审核功能正常（如适用）

## 安全检查

- [ ] JWT_SECRET 已更改为强随机字符串（不是默认值）
- [ ] MongoDB 密码足够强
- [ ] 环境变量中没有硬编码的敏感信息
- [ ] `.env` 文件已添加到 `.gitignore`
- [ ] 生产环境使用 HTTPS

## 监控和日志

- [ ] Vercel 部署日志正常
- [ ] Railway/Render 部署日志正常
- [ ] 错误监控已配置（如适用）
- [ ] 性能监控已配置（如适用）

## 文档

- [ ] 部署文档已阅读: [DEPLOYMENT.md](./DEPLOYMENT.md)
- [ ] 环境变量文档已阅读: [ENV_VARIABLES.md](./ENV_VARIABLES.md)
- [ ] 团队成员已了解部署流程

## 后续优化

- [ ] 配置自定义域名（如需要）
- [ ] 设置 CI/CD 自动部署
- [ ] 配置数据库备份
- [ ] 设置监控和告警
- [ ] 优化性能（如需要）

## 故障排除

如果遇到问题，检查：

1. **CORS 错误**
   - [ ] 后端 `CORS_ORIGIN` 包含前端 URL
   - [ ] URL 格式正确（包括 `https://`）
   - [ ] 后端服务已重启

2. **数据库连接错误**
   - [ ] MongoDB Atlas 网络访问配置正确
   - [ ] 连接字符串格式正确
   - [ ] 数据库用户权限正确

3. **环境变量问题**
   - [ ] 变量名拼写正确
   - [ ] 前端变量以 `NEXT_PUBLIC_` 开头
   - [ ] 变量值格式正确
   - [ ] 服务已重启/重新部署

4. **构建错误**
   - [ ] 检查构建日志
   - [ ] 确认依赖安装成功
   - [ ] 检查代码错误

## 完成

部署完成后，确保：
- [ ] 所有功能测试通过
- [ ] 文档已更新
- [ ] 团队成员已通知
- [ ] 备份计划已制定

---

**提示**: 保存此清单的副本，在每次部署时使用。

